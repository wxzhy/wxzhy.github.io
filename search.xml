<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Azure 账号</title>
    <url>/archives/2023/03/Azure%E8%B4%A6%E5%8F%B7/</url>
    <content><![CDATA[<h1 id="azure账号收购">Azure 账号收购</h1>
<aside>
<p>💡 联系：</p>
<p>E-mail: <a href="mailto:me@iccn.top">me@iccn.top</a> (推荐)</p>
</aside>
<blockquote>
<p>微软的云服务 (Azure) 已经存在很长时间了，后来推出了学生订阅。用合法的教育邮箱注册，就能领 $100 的体验金和 1 年免费 b1s 主机 (1c1g) 带 64g 磁盘。然而，其他专业的学生并不需要，也不会使用这种服务，于此同时，信息相关专业学生需要云主机进行实践，如网站建设等操作。通过转让相关账号，可以促成资源的合理分配。</p>
</blockquote>
<hr>
<h2 id="azure是什么">Azure 是什么？</h2>
<p>Azure 是微软提供的云计算平台，提供广泛的服务和解决方案，以满足各种规模的组织和企业的需求。它提供可扩展和可靠的基础设施，安全的存储解决方案和智能的分析和报告工具，以帮助学校和大学构建强大的学生注册系统。</p>
<h2 id="什么是azure学生订阅">什么是 Azure 学生订阅？</h2>
<p>Azure 学生订阅是微软提供的云计算服务中的一项，允许合法的教育邮箱注册用户免费领取 $100 的体验金和 1 年免费 b1s 主机 (1c1g) 带 64g 磁盘。这对于需要云主机进行实践（如网站建设等操作）的信息相关专业学生来说是非常有吸引力的。</p>
<h2 id="它有什么作用">它有什么作用？</h2>
<p>确实，1c1g 的云主机做不了什么，性能对于动态网页和数据库来说并不充裕。然而，Microsoft 的网络对中国用户进行了优化，通过其在香港和新加坡的 PoP 能以较高的速度和较低的延时访问。使用这些机器作为反向代理，可以优化国内访客的体验，同时大幅节约运维费用。</p>
<p>此外，这些主机还能作为正向代理，加速国外数据库、软件源和源码的拉取速度，进而改善部分软件的编译和使用体验。</p>
<blockquote>
<p>关于国外主机用来做什么，大家都心知肚明，不就是将流量转发到服务器，再从服务器转发到目标网站吗。</p>
<p>所以，配置完也会把对应软件和配置打包发回。</p>
</blockquote>
<h2 id="关于个人信息安全">关于个人信息安全</h2>
<p>注册时会提示相应资料可能传输至境外，微软作为跨国大型企业，有完善的用户数据保护机制。注册时需要教育邮箱和手机号仅供验证使用，以验证学生身份，同时防止欺诈。</p>
<p>相关服务使用时均合法合规，仅作转发流量用途，不会记录访问日志，用户访问时均采用 https 加密，防止第三方窃听。</p>
<hr>
<h1 id="详细注册流程"><strong>详细注册流程</strong></h1>
<h3 id="退出代理软件和vpn">1. 退出代理软件和 VPN。</h3>
<p>访问<a href="http://ip111.cn/">此页面</a>检查 IP 是否为国内 IP。如下图所示，如果正确操作，页面上 IP 属地都应该在国内。</p>
<img src="/archives/2023/03/Azure%E8%B4%A6%E5%8F%B7/Untitled.png" class="" title="Untitled">
<h3 id="访问azure-for-students网站httpsazure.microsoft.comzh-cnfreestudents">2. 访问 Azure
for Students 网站（<a href="https://azure.microsoft.com/zh-cn/free/students/%EF%BC%89">https://azure.microsoft.com/zh-cn/free/students/）</a></h3>
<aside>
<p>💡 注意点：
1. 如果你以前登录过 Azure 需新建一个浏览器实例。具体操作：点击右上角的用户头像，弹出菜单中点加号。</p>
<p>2. 该页面位于国外，加载比较缓慢，注册过程中可以最小化浏览器或做些别的事情。</p>
<p>3. 最好避开晚高峰时段（大概 19 点到次日 1 点），最好选早上或中午注册，页面打开速度较快。</p>
</aside>
<h3 id="点击开始使用填入相关信息">3. 点击开始使用，填入相关信息</h3>
<img src="/archives/2023/03/Azure%E8%B4%A6%E5%8F%B7/1.png" class="" title="Untitled">
<p>在弹出的登录页面中，点创建账号，用学校的邮箱（以 edu.cn 结尾）注册，密码随机生成一个（妥善保管）, 之后登录校园邮箱，会有这样的邮件。</p>
<p>​</p>
<img src="/archives/2023/03/Azure%E8%B4%A6%E5%8F%B7/2.png" class="" title="Untitled">
<p>输入安全代码，之后完成验证码。</p>
<h3 id="验证手机号">4. 验证手机号</h3>
<img src="/archives/2023/03/Azure%E8%B4%A6%E5%8F%B7/3.png" class="" title="Untitled">
<p>在如下界面选择中国，输入你的手机号（仅供验证使用），发送验证码。</p>
<h3 id="填写相关信息">5. 填写相关信息</h3>
<p>在随后的界面中填写姓名（名单里随便找一个就行），邮箱（不要填错），大学名称，点击验证学术地位。</p>
<h3 id="打开邮箱">6. 打开邮箱</h3>
<p>应该会有这样一封邮件，点击上面的链接。</p>
<img src="/archives/2023/03/Azure%E8%B4%A6%E5%8F%B7/4.png" class="">
<h3 id="填写对应信息">7. 填写对应信息</h3>
<p>名字名单里随便找一个，但最好和上面填的一样。</p>
<aside>
<p>💡 注意：</p>
<p>姓和名时分开的。如果出现英文界面的话，First Name 填名，Last
Name 填姓。</p>
</aside>
<img src="/archives/2023/03/Azure%E8%B4%A6%E5%8F%B7/5.png" class="" title="Untitled">
<p>同样，填入名字，邮箱，电话，地址填学校地址或学校周边的建筑物的地址，邮编网上查一下所在的的邮政编码，勾选第一个，注册。</p>
<img src="/archives/2023/03/Azure%E8%B4%A6%E5%8F%B7/6.png" class="" title="Untitled">
<blockquote>
<p>跳出这个界面的话按上面说的来，选择使用此地址。</p>
</blockquote>
<img src="/archives/2023/03/Azure%E8%B4%A6%E5%8F%B7/7.png" class="" title="Untitled">
<h3 id="如果跳转到这个界面就说明失败了不用再管了">8. 如果跳转到这个界面就说明失败了，不用再管了</h3>
<aside>
<p>💡 Azure 的注册规则很迷，可能成功也可能不成功，主要看注册 IP 和手机号。
<del>据我所知，一些号段可以，一些号段就不可以。</del></p>
<blockquote>
<p>2023 年 9 月：</p>
<p>似乎现在政策变了，用教育邮箱认证后直接能用，但开出的 IP 路由没以前好，还是推荐用 Japan
East，最好用 IPv6 连接。</p>
</blockquote>
</aside>
<img src="/archives/2023/03/Azure%E8%B4%A6%E5%8F%B7/8.png" class="" title="Untitled">
<p>能跳转至类似下图所示界面就说明成功了。</p>
<img src="/archives/2023/03/Azure%E8%B4%A6%E5%8F%B7/9.png" class="" title="Untitled">
<p><strong>如果你这一步没出现上图界面，而跳转到控制台，那么恭喜你注册成功了。如果不知道怎么用的话，可以把账号密码通过联系方式发给我（可以要红包）。</strong></p>
<hr>
<p>感谢你们花如此长的时间看完这篇文章，如果有缘，以后再见……</p>
<hr>
<p>The end.</p>
<hr>
]]></content>
      <tags>
        <tag>manual</tag>
      </tags>
  </entry>
  <entry>
    <title>proxmox 上 amdgpu 的安装</title>
    <url>/archives/2023/09/amdgpu-on-proxmox/</url>
    <content><![CDATA[<h2 id="在proxmox-ve上使用amdgpu">在 Proxmox VE 上使用 amdgpu</h2>
<p>仅供参考</p>
<p><strong>文中所述的环境为 Proxmox VE 8.0，kernel 6.2</strong></p>
<p>网上关于 Proxmox
VE 直通 GPU 到 LXC 的教程遍地都是，在视频解码等应用下确实可行，然而，当尝试运行 OpenCL 相关操作时就会遇到问题。</p>
<p>大多数教程都是这么说的：</p>
<h3 id="关于n卡">关于 N 卡</h3>
<p>按照正常方法安装 Nvidia 的 dkms 驱动，然后直通一些文件到 lxc 中，修改 <code>/etc/pve/lxc/&lt;id&gt;.conf</code>
之后添加</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">lxc.cgroup.devices.allow: c 195:* rwm</span><br><span class="line">lxc.cgroup.devices.allow: c 234:* rwm</span><br><span class="line">lxc.cgroup.devices.allow: c 226:* rwm</span><br><span class="line">lxc.mount.entry: /dev/nvidia0 dev/nvidia0 none bind,optional,create=file</span><br><span class="line">lxc.mount.entry: /dev/nvidia1 dev/nvidia1 none bind,optional,create=file</span><br><span class="line">lxc.mount.entry: /dev/nvidiactl dev/nvidiactl none bind,optional,create=file</span><br><span class="line">lxc.mount.entry: /dev/nvidia-uvm dev/nvidia-uvm none bind,optional,create=file</span><br><span class="line">lxc.mount.entry: /dev/nvidia-modeset dev/nvidia-modeset none bind,optional,create=file</span><br><span class="line">lxc.mount.entry: /dev/nvidia-uvm-tools dev/nvidia-uvm-tools none bind,optional,create=file</span><br><span class="line">lxc.mount.entry: /dev/dri dev/dri none bind,optional,create=dir</span><br></pre></td></tr></tbody></table></figure>
<p>一般来说，对应的 id 和目录可以通过 <code>ls -la /dev</code> 和 <code>ls -la /dev/dri</code> 获得。</p>
<p>对应 intel 的核显，应该改为</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">lxc.cgroup.devices.allow: c 226:128 rwm</span><br><span class="line">lxc.cgroup.devices.allow: c 226:0 rwm</span><br><span class="line">lxc.mount.entry: /dev/dri dev/dri none bind,optional,create=dir</span><br></pre></td></tr></tbody></table></figure>
<h3 id="host驱动的安装">Host 驱动的安装</h3>
<p>从 https://repo.radeon.com 下安装 amdgpu-install 软件包，注意要选择最新的（以）</p>
<h3 id="网上教程的坑">网上教程的坑</h3>
<p>但对于 AMD 的核显 / 独显，教程几乎都忘了加 <code>/dev/kfd</code>，这样让 OpenCL 不能工作。</p>
<p>一开始，我按照大多数教程所说，passthrough 了 <code>/dev/dri</code> 目录发现无法正常工作，后来从 docker 部署 pytorch 的文档中了解到还有 <code>/dev/kfd</code></p>
<p>正确的做法:</p>
<p>在文件后添加:</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">lxc.cgroup2.devices.allow: c 226:0 rwm</span><br><span class="line">lxc.cgroup2.devices.allow: c 226:128 rwm</span><br><span class="line">lxc.mount.entry: /dev/dri dev/dri none bind,optional,create=dir</span><br><span class="line">lxc.cgroup2.devices.allow: c 234:0 rwm</span><br><span class="line">lxc.apparmor.profile: unconfined</span><br><span class="line">lxc.mount.entry: /dev/kfd dev/kfd none bind,optional,create=file</span><br></pre></td></tr></tbody></table></figure>
<p>重启 lxc 后，按正常方法安装 amdgpu 驱动，注意添加 <code>--no-dkms</code> 选项，就可以了。</p>
]]></content>
      <tags>
        <tag>Homelab</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/archives/2023/08/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very
first post. Check <a href="https://hexo.io/docs/">documentation</a> for
more info. If you get any problems when using Hexo, you can find the
answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or
you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="quick-start">Quick Start</h2>
<h3 id="create-a-new-post">Create a new post</h3>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></tbody></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="run-server">Run server</h3>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></tbody></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="generate-static-files">Generate static files</h3>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></tbody></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="deploy-to-remote-sites">Deploy to remote sites</h3>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></tbody></table></figure>
<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
      <tags>
        <tag>test</tag>
      </tags>
  </entry>
  <entry>
    <title>test</title>
    <url>/archives/2023/08/test/</url>
    <content><![CDATA[<p>Hello world</p>
<h3 id="math-render-test">Math render test</h3>
<p><span class="math display">\[
evidence_{i}=\sum_{j}W_{ij}x_{j}+b_{i}
\]</span></p>
<h3 id="code">Code</h3>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> this</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    requests.session()</span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>{</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="image-cdn-test">Image CDN test</h3>
<p>Github:</p>
<img src="/archives/2023/08/test/test.jpg" class="" title="010508ux2tc0evhzmevixj">
<p>Jsdelivr:</p>
<figure>
<img src="https://cdn.jsdelivr.net" alt="test">
<figcaption aria-hidden="true">test</figcaption>
</figure>
<p>Cloudflare: <img src="https://images.tomzhu.me/images/test.jpg" alt="test"> US region: <img src="https://files.tomzhu.tech/images/test.jpg" alt="test"></p>
<p>Gcore: <img src="https://cdn2.tomzhu.me/images/test.jpg" alt="test"></p>
]]></content>
      <tags>
        <tag>Testing</tag>
      </tags>
  </entry>
  <entry>
    <title>往事</title>
    <url>/archives/2023/08/the-past/</url>
    <content><![CDATA[<p><strong>曾经的故事</strong></p>
<p>在 2019-2022 这三年间，我可能做了许多，然而又可以说是浪费了不少时间。<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<h3 id="缘起"><strong>缘起</strong></h3>
<p>学校里的电脑本来是不能上网的，而且一直应当如此。</p>
<h3 id="最简单的方法"><strong>最简单的方法</strong></h3>
<p>在 2019 年，我看到登录界面的过程，自然而然地想到了通过某些手段获得别人的密码用以登录。后来由于设备数限制不得不放弃。</p>
<p>有个做 OI 的大佬，开发的 <a href="https://disk.tomzhu.me/s/AqUa">weblogin 程序</a>，用了 winsock 发送 post 请求，登录网络。里面密码还不是明文存储，他自己构建了一个算法，做了 encode 和 decode 的程序。（不过，在现在看来是多此一举，直接分析 HTTP 请求，甚至用调试器不就能得到密码吗，这个算法意义何在？）</p>
<h3 id="简单的网络穿透"><strong>简单的网络穿透</strong></h3>
<p>很早以前，某人就发现网络就算不登陆，也能进行 ping 和 nslookup 等操作，并且能得到正确的响应。推测是网管为了配置方便放行了一些端口，如 DHCP,
DNS 等。</p>
<p>后来，我了解能用 ICMP 和 DNS 上网的功能，是来自于 Softether 里的一种功能。</p>
<img src="/archives/2023/08/the-past/c1.jpg" class="" title="1. Ultimate Powerful VPN Connectivity - SoftEther VPN Project">
<p>但当我配好拿到学校去试，就发现报错，怀疑功能不完善，之后的一年便相安无事。</p>
<p>后来王某发现了 <a href="https://github.com/wangyu-/udp2raw">udp2raw</a>，当时用了腾讯云 30M 的香港 vps 来测试，发现速度飞快，Google 几乎是秒开。可惜后来线路不走 CN2 了，价格也贵了不少，还一直断货。</p>
<blockquote>
<p>📋
当时 udp2raw 配合影梭和 kcptun，几乎是完美的上网方法，而且居然能在 2 年的时间内一直稳定使用。</p>
</blockquote>
<h3 id="远程桌面psexec和cobaltstrike">远程桌面，psexec 和 cobaltstrike</h3>
<p>刚开始，就有人发现校内网路并没有隔离，各个主机能直接 ping 通，而且完全没有防火墙，就有了很多玩法。</p>
<p>那儿的机器 win7 的补丁打到 2017 年，win10 也是 1709 的版本。他们以为装了还原卡就啥事也没有了。</p>
<blockquote>
<p>所以 eternalblue 和 smbghost 的 exploit 应该是可用的，只要找个 msf 就行，同样那时没人会用。</p>
</blockquote>
<p>相关玩法如下：</p>
<table>
<thead>
<tr class="header">
<th>用途</th>
<th>方法</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>远程关机</td>
<td>通过 <code>shutdown -I</code> 调出远程关机对话框</td>
</tr>
<tr class="even">
<td>远程桌面</td>
<td>直接使用 <code>mstsc</code> 连接，然后随意玩耍</td>
</tr>
<tr class="odd">
<td> psexec</td>
<td> 登上对应机器的 system shell, 随意执行命令例如播放声音和弹框</td>
</tr>
<tr class="even">
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>又是一段时间，某人带来了批量关机脚本（其实没啥含量，一个循环的 bat 就行）。自从他们发现远程桌面之后，内网屏蔽了 <code>3389/tcp</code> 然而 psexec 还是一直可用。</p>
<p>之后，貌似有人提出在还原卡被停用的机器上装 <code>cobaltstrike beacon</code>，这样可以简化大量工作，然而那时几乎没有人有 vps，只好作罢。</p>
<h3 id="电子班牌和代理服务">电子班牌和代理服务</h3>
<p>在大概 21 年寒假，刚从疫情回来，我们莫名其妙发现了电子班牌，这种 Android 设备简直是开发板自带系统加一个蹩脚 app 的组合，而且用一个 <code>rc.local</code> 脚本启动对应 app。而那个叫做 “晓慧云” 的 app 基本上是中间件的堆砌，维持在能用和不能用直接，甚至一些简单的操作如重复刷新等都会造成崩溃。（其实，大多数的嵌入式产品都是如此）</p>
<p>感兴趣的话，可以在<a href="https://disk.tomzhu.me/s/6diE">这个链接</a>中找到原来的 apk，里面的 api
key 应该到现在还能用。</p>
<p>原先的修改方式非常原始，直接将隐藏导航栏、切前台、自动重启相关函数改为空（即在最前添加 <code>return void</code>），这样让大多数烦人的功能都去除，让班牌变成了平板电脑（当然，一开始也没有人发现这种动了手脚的 apk），还用了 oss 来分发。</p>
<blockquote>
<p>当时我确实对 APK 的结构知之甚少，当初这么做只是调试容易，正确的方法应该直接修改判定逻辑。不过那时能找到需要 patch 的函数已经不大容易了。</p>
</blockquote>
<p>班牌还有的用处是安装代理，让电脑能够上网。（没错，两个网段直接就是啥隔离也没有，那些 win7 补丁只打到 17 年，后面还有人用 msf 和 psexec 搞事）</p>
<img src="/archives/2023/08/the-past/PSEXEC-1.jpg" class="" title="How to: become the LOCAL SYSTEM account with PsExec - Specops Software">
<h4 id="最简单的web服务">最简单的 web 服务</h4>
<p>一开始，在王某做了修改版的 apk 之后，就又有人买了服务器，分发 APK 和使用教程。结果不久之后，被强制修改 dns。</p>
<p>可惜效果不好，可能把很多的影视网站给封了，于是他们又改变了规则，只有学生能自由活动的时间不能访问……</p>
<p>（也可能是学校第一次使用这个 Fortigate 设备，还把<code>.xyz,.top,.me,.cf,.ga,.gq,.tk,.ml</code> 这些后缀全搞掉了，看上去这种班牌变平板的事情比电脑突然发出声音严重多了）</p>
<h3 id="结束">结束</h3>
<p>最终，那种班牌的厂商做了很大的改进，通过在学校内部安装反向代理，然后屏蔽了班牌的出网权限 <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>。至此，所有相关的事情，都走到了尽头，只能依赖教师账号的邀请码上网了，这种方法直到一年之后仍能使用。</p>
<p>在最后的一个月里，有人又翻出来这些事情去举报，然而相关人员早已毫无兴趣了。</p>
<h3 id="后来">后来</h3>
<p>我那一届走之后，校内政策发生很大的变化，再也没有接近一个小时的晚饭时间，剩下的实验楼和空教室也不在开放，走廊里时不时有教职工巡查，没有人能够安全地接触到一体机或是电子班牌，一切似乎回归了平静。</p>
<p>将来的学生绝对不会记得有过一段时间，学生能够自由地出入校园的几乎所有地方，还能通过校内的各种设备上网。也不会记得有人<del>无私地</del>花费了不少时间研究，只为找到能够快速浏览网页的方法。最终什么也没留下，连往事都很快被淡忘。</p>
<p>之后，总会有人去尝试，去探索，这几年发生的事情会一遍遍重演，然而再也没有曾经的我们，那些前辈的事迹终将鲜为人知。</p>
<aside id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>确实是浪费，毕竟最后也没啥用。<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>后来得到的内网端口文件证实了这一推测，依旧可以从<a href="https://disk.ningsuan.com.cn/#s/8J_AaUAw">此处，密码 hijk</a> 得到。<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</aside>
]]></content>
      <tags>
        <tag>Past</tag>
      </tags>
  </entry>
</search>
